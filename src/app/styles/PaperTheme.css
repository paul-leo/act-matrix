/* 
 * 纸质书写主题 - 全局主题变量
 * 基于 Ionic 高级主题系统
 * 强制使用亮色模式，忽略系统深色模式设置
 */

:root {
  /* 强制覆盖深色模式，确保始终使用亮色主题 */
  color-scheme: light !important;
  /* ===== 纸质感色彩系统 ===== */
  --paper-cream: #FDFCF9;
  --paper-white: #FFFFFF;
  --paper-black: #1a1a1a;
  --paper-aged: #F8F6F2;
  --ink-black: #2c2c2c;
  --ink-blue: #2563eb;
  --ink-brown: #8b4513;
  --muted-ink: #6b7280;
  --pencil-gray: #9ca3af;
  --line-color: #e5e7eb;
  --accent-brown: #7c5d3f;
  --accent-weak: #d1c7b8;
  --shadow-paper: rgba(0, 0, 0, 0.12);
  --shadow-deep: rgba(0, 0, 0, 0.18);
  
  /* ===== RGB 格式（用于透明度） ===== */
  --paper-cream-rgb: 253, 252, 249;
  --ink-black-rgb: 44, 44, 44;
  --accent-brown-rgb: 124, 93, 63;
  --muted-ink-rgb: 107, 114, 128;
  
  /* ===== Ionic 主题色覆盖 ===== */
  --ion-color-primary: var(--accent-brown);
  --ion-color-primary-rgb: var(--accent-brown-rgb);
  --ion-color-primary-contrast: #ffffff;
  --ion-color-primary-contrast-rgb: 255, 255, 255;
  --ion-color-primary-shade: #654a36;
  --ion-color-primary-tint: #8a6b4f;
  
  /* 次要颜色 - 温暖的纸质感 */
  --ion-color-secondary: #d1c7b8;
  --ion-color-secondary-rgb: 209, 199, 184;
  --ion-color-secondary-contrast: #2c2c2c;
  --ion-color-secondary-contrast-rgb: 44, 44, 44;
  --ion-color-secondary-shade: #b8aea2;
  --ion-color-secondary-tint: #d6ccbf;
  
  /* 成功色 - 自然绿 */
  --ion-color-success: #16a34a;
  --ion-color-success-rgb: 22, 163, 74;
  --ion-color-success-contrast: #ffffff;
  --ion-color-success-contrast-rgb: 255, 255, 255;
  --ion-color-success-shade: #15803d;
  --ion-color-success-tint: #22c55e;
  
  /* 警告色 - 温暖橙 */
  --ion-color-warning: #ea580c;
  --ion-color-warning-rgb: 234, 88, 12;
  --ion-color-warning-contrast: #ffffff;
  --ion-color-warning-contrast-rgb: 255, 255, 255;
  --ion-color-warning-shade: #c2410c;
  --ion-color-warning-tint: #f97316;
  
  /* 危险色 - 温和红 */
  --ion-color-danger: #dc2626;
  --ion-color-danger-rgb: 220, 38, 38;
  --ion-color-danger-contrast: #ffffff;
  --ion-color-danger-contrast-rgb: 255, 255, 255;
  --ion-color-danger-shade: #b91c1c;
  --ion-color-danger-tint: #ef4444;
  
  /* 深色 - 墨水色 */
  --ion-color-dark: var(--ink-black);
  --ion-color-dark-rgb: var(--ink-black-rgb);
  --ion-color-dark-contrast: var(--paper-cream);
  --ion-color-dark-contrast-rgb: var(--paper-cream-rgb);
  --ion-color-dark-shade: #111827;
  --ion-color-dark-tint: #374151;
  
  /* 中等色 - 铅笔灰 */
  --ion-color-medium: var(--pencil-gray);
  --ion-color-medium-rgb: 156, 163, 175;
  --ion-color-medium-contrast: #ffffff;
  --ion-color-medium-contrast-rgb: 255, 255, 255;
  --ion-color-medium-shade: #6b7280;
  --ion-color-medium-tint: #d1d5db;
  
  /* 浅色 - 纸张色 */
  --ion-color-light: var(--paper-cream);
  --ion-color-light-rgb: var(--paper-cream-rgb);
  --ion-color-light-contrast: var(--ink-black);
  --ion-color-light-contrast-rgb: var(--ink-black-rgb);
  --ion-color-light-shade: #e5e2da;
  --ion-color-light-tint: #faf9f6;
  
  /* ===== 全局应用变量 ===== */
  --ion-background-color: var(--paper-white);
  --ion-background-color-rgb: var(--paper-cream-rgb);
  
  --ion-text-color: var(--ink-black);
  --ion-text-color-rgb: var(--ink-black-rgb);
  
  --ion-border-color: var(--line-color);
  
  /* 字体系统 - 书写感字体 */
  --ion-font-family: 
    ui-serif, 
    Georgia, 
    Cambria, 
    "Times New Roman", 
    Times, 
    serif,
    -apple-system, 
    BlinkMacSystemFont, 
    "Segoe UI", 
    Roboto, 
    Helvetica, 
    Arial, 
    sans-serif;
  
  /* 间距系统 */
  --ion-margin: 16px;
  --ion-padding: 16px;
  
  /* 占位符透明度 */
  --ion-placeholder-opacity: 0.6;
  
  /* ===== 纸质感特效变量 ===== */
  --paper-texture-opacity: 0.02;
  --paper-grain-size: 16px;
  --paper-shadow-soft: 0 2px 8px rgba(0, 0, 0, 0.06);
  --paper-shadow-medium: 0 4px 16px rgba(0, 0, 0, 0.08);
  --paper-shadow-strong: 0 8px 32px rgba(0, 0, 0, 0.12);
  --paper-border-radius: 8px;
  --paper-border-radius-large: 12px;
}

/* ===== Base typography scaling ===== */
html {
  font-size: 16px;
}

@media (min-width: 1024px) {
  html {
    font-size: 24px; /* ~1.5x for desktop */
  }
}

/* ===== 全局纸质感背景 ===== */
body {
  background: 
    /* 纸质纹理叠加 */
    radial-gradient(circle at 20% 80%, rgba(122, 108, 93, 0.03) 0%, transparent 50%),
    radial-gradient(circle at 80% 20%, rgba(203, 187, 165, 0.04) 0%, transparent 50%),
    radial-gradient(circle at 40% 40%, rgba(74, 73, 71, 0.02) 0%, transparent 50%),
    /* 主渐变背景 */
    linear-gradient(135deg, #4A4947 0%, #3d3c3a 25%, #4A4947 50%, #3a3938 75%, #4A4947 100%),
    /* 细微的纸质纹理 */
    repeating-linear-gradient(
      45deg,
      transparent,
      transparent 2px,
      rgba(255, 255, 255, 0.005) 2px,
      rgba(255, 255, 255, 0.005) 4px
    );
  font-family: var(--ion-font-family);
  color: var(--ion-text-color);
}

/* 为 body 添加纸质纹理伪元素 */
body::before {
  content: "";
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-image:
    /* 随机点状纹理模拟纸质感 */
    radial-gradient(circle at 25% 25%, rgba(255, 255, 255, 0.008) 1px, transparent 1px),
    radial-gradient(circle at 75% 75%, rgba(0, 0, 0, 0.01) 1px, transparent 1px),
    radial-gradient(circle at 50% 10%, rgba(203, 187, 165, 0.015) 1px, transparent 1px),
    radial-gradient(circle at 10% 90%, rgba(122, 108, 93, 0.012) 1px, transparent 1px);
  background-size: 
    40px 40px,
    60px 60px,
    80px 80px,
    100px 100px;
  background-position:
    0 0,
    20px 20px,
    40px 40px,
    60px 60px;
  pointer-events: none;
  z-index: -1;
}

/* ===== 纸质感组件基础样式 ===== */

/* 卡片纸质感 */
ion-card {
  --background: var(--paper-cream);
  --color: var(--ink-black);
  border: 1px solid var(--line-color);
  box-shadow: 
    var(--paper-shadow-medium),
    inset 0 1px 0 rgba(255, 255, 255, 0.8),
    inset 0 -1px 0 rgba(0, 0, 0, 0.05);
  border-radius: var(--paper-border-radius-large);
  position: relative;
}

/* 为卡片添加纸质纹理 */
ion-card::before {
  content: "";
  position: absolute;
  inset: 0;
  border-radius: inherit;
  pointer-events: none;
  background-image:
    radial-gradient(circle at 20% 30%, rgba(122, 108, 93, 0.015) 1px, transparent 1px),
    radial-gradient(circle at 80% 70%, rgba(203, 187, 165, 0.02) 1px, transparent 1px);
  background-size: 20px 20px, 24px 24px;
  background-position: 0 0, 8px 8px;
  z-index: 0;
}

/* 确保卡片内容在纹理之上 */
ion-card-header,
ion-card-content {
  position: relative;
  z-index: 1;
}

/* 按钮纸质感 */
ion-button {
  --border-radius: var(--paper-border-radius);
  --box-shadow: var(--paper-shadow-soft), inset 0 1px 0 rgba(255, 255, 255, 0.3);
  font-family: var(--ion-font-family);
}

ion-button:hover {
  --box-shadow: var(--paper-shadow-medium), inset 0 1px 0 rgba(255, 255, 255, 0.4);
}

/* 输入框纸质感 */
ion-input,
ion-textarea {
  --background: var(--paper-white);
  --color: var(--ink-black);
  --border-color: var(--line-color);
  --border-radius: var(--paper-border-radius);
  --padding-start: 12px;
  --padding-end: 12px;
  --padding-top: 8px;
  --padding-bottom: 8px;
  font-family: var(--ion-font-family);
}

/* 工具栏纸质感 */
ion-toolbar {
  --background: var(--paper-cream);
  --color: var(--ink-black);
  --border-color: var(--line-color);
  --padding-start: 16px;
  --padding-end: 16px;
}

/* 标题纸质感 */
ion-title {
  font-family: var(--ion-font-family);
  font-weight: 600;
  color: var(--ink-black);
}

/* 列表纸质感 */
ion-list {
  --background: transparent;
}

ion-item {
  --background: var(--paper-cream);
  --color: var(--ink-black);
  --border-color: var(--line-color);
  --padding-start: 16px;
  --padding-end: 16px;
  font-family: var(--ion-font-family);
}

/* 模态框纸质感 */
ion-modal {
  --background: var(--paper-cream);
  --color: var(--ink-black);
}

/* 浮动按钮纸质感 */
ion-fab-button {
  --background: linear-gradient(135deg, var(--accent-brown) 0%, #6b5d52 50%, var(--accent-brown) 100%);
  --color: #ffffff;
  --box-shadow: 
    0 6px 20px rgba(0, 0, 0, 0.15),
    0 2px 8px rgba(0, 0, 0, 0.1),
    inset 0 1px 0 rgba(255, 255, 255, 0.3),
    inset 0 -1px 0 rgba(0, 0, 0, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
}

/* ===== 强制覆盖深色模式 ===== */
/* 确保在任何情况下都使用亮色纸质主题 */
@media (prefers-color-scheme: dark) {
  :root {
    /* 强制覆盖所有深色模式变量为亮色值 */
    color-scheme: light !important;
    
    /* 重新声明所有主要颜色变量，确保深色模式下也使用亮色 */
    --ion-background-color: var(--paper-cream) !important;
    --ion-background-color-rgb: var(--paper-cream-rgb) !important;
    --ion-text-color: var(--ink-black) !important;
    --ion-text-color-rgb: var(--ink-black-rgb) !important;
    --ion-border-color: var(--line-color) !important;
    
    /* 确保所有 Ionic 组件在深色模式下也使用亮色主题 */
    --ion-color-step-50: #fafafa !important;
    --ion-color-step-100: #f5f5f5 !important;
    --ion-color-step-150: #f0f0f0 !important;
    --ion-color-step-200: #ebebeb !important;
    --ion-color-step-250: #e6e6e6 !important;
    --ion-color-step-300: #e1e1e1 !important;
    --ion-color-step-350: #dcdcdc !important;
    --ion-color-step-400: #d7d7d7 !important;
    --ion-color-step-450: #d2d2d2 !important;
    --ion-color-step-500: #cdcdcd !important;
    --ion-color-step-550: #c8c8c8 !important;
    --ion-color-step-600: #c3c3c3 !important;
    --ion-color-step-650: #bebebe !important;
    --ion-color-step-700: #b9b9b9 !important;
    --ion-color-step-750: #b4b4b4 !important;
    --ion-color-step-800: #afafaf !important;
    --ion-color-step-850: #aaaaaa !important;
    --ion-color-step-900: #a5a5a5 !important;
    --ion-color-step-950: #a0a0a0 !important;
  }
}

/* 强制所有元素使用亮色模式 */
* {
  color-scheme: light !important;
}

/* 确保 body 和 html 也强制使用亮色 */
html, body {
  color-scheme: light !important;
  background-color: var(--paper-cream) !important;
  color: var(--ink-black) !important;
  font-weight: 400;
}

/* 强制 Ionic 应用容器使用亮色 */
ion-app, 
.ion-page, 
ion-content {
  --background: var(--paper-cream) !important;
  --color: var(--ink-black) !important;
  background: var(--paper-cream) !important;
  color: var(--ink-black) !important;
}

/* 增强文字对比度 */
h1, h2, h3, h4, h5, h6 {
  color: var(--ink-black) !important;
  font-weight: 600 !important;
}

p, span, div {
  color: var(--ink-black) !important;
}

/* 确保所有 Ionic 组件文字颜色 */
ion-label, 
ion-title, 
ion-button, 
ion-item {
  --color: var(--ink-black) !important;
  color: var(--ink-black) !important;
}

/* 确保次要文字也有足够对比度 */
.muted, 
.secondary {
  color: var(--muted-ink) !important;
}

/* ===== 响应式纸质感调整 ===== */
@media (max-width: 768px) {
  :root {
    --ion-margin: 12px;
    --ion-padding: 12px;
    --paper-border-radius: 6px;
    --paper-border-radius-large: 10px;
  }
}

@media (max-width: 480px) {
  :root {
    --ion-margin: 8px;
    --ion-padding: 8px;
    --paper-border-radius: 4px;
    --paper-border-radius-large: 8px;
  }
}
